1. Архитектура 
Для добавления методов авторизации используется плагинная архитектура. Это сделано для того, чтобы очень быстро, практически не меняя существующий код внедрять новые методы авторизации. Новые методы внедряются с помощью наследованния от метакласса AuthMethod. Все остальное сделано по обычным паттернам.

2. Регистрация через email
Чтобы зарегистрироваться через email надо дернуть ручку /email/registrate. Туда передается email и пароль через json. Регистрация через email доступна для незарегестрированных пользователей или для пользователей у которых определены методы регистрации, но не email. Возможны несколько исходов регистрации:

2.1 Успешно - 201

Если пользователь зарегестрирован. Ему отправляется письмо для подтверждения почты, где есть ссылка, переходя нна которую происходит подтверждение.

2.2 Успешно - 200

Если пользщователь уже регестрировался, но не подтвердил свою почту. Ему отправляется повторное письмо, где есть новый линк. 

2.3 AlreadyExists - 409

Если пользователь уже зарегистрироваля и подтвердил почту.

2.4 ObjectNotFound - 404

Если указано для какого пользователя добавить метод регистрации и этого пользователя не существует.

2.5 SessionExpired - 403

Если указано для какого пользователя добавить метод регистрации, указана его сессия, которая, в свою очередь, протухла.

При любом исходе возвращает т.н ResponseModel = {status: str, message: str}

3. Логин через email. 

Чтобы залогиниться надо дернуть ручку email/login. Туда передается email, password. Что может быть, если дернуть ручку:

3.1 AuthFailed - 401

Если логин+пароль неправильный или если пользователь не подтвердил email.

3.2 Успешно - 200

Возвращает в таком случае объект UserSession = {id: int, token: str, expires: datetime}

4. Смена пароля

Чтобы поменять пароль, существует два варианта: либо поменять его из открытой сессии: нужен email, password, new_password, token, либо в случае забытого пароля можно пользоваться только email.

4.1 Восстановление без сессии

Надо дернуть ручку /email/password/reset/request, передать туда email. На почту приходит письмо со ссылкой на фронт, где можно поменять пароль, там есть reset_token в ссылке. Далее 
